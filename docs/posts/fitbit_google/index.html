<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.121">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Maria Prokofieva">
<meta name="dcterms.date" content="2023-10-30">

<title>MyDataRules (MyDR) - Fitbit in your Google Sheets in 5 min or less</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon-16x16.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-MB64NTVJTB"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-MB64NTVJTB', { 'anonymize_ip': true});
</script>


<meta property="og:title" content="MyDataRules (MyDR) - Fitbit in your Google Sheets in 5 min or less">
<meta property="og:description" content="">
<meta property="og:site-name" content="MyDataRules">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">MyDataRules (MyDR)</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">What’s new</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index_b.html" rel="" target="">
 <span class="menu-text">Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html" rel="" target="">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.meetup.com/r-business/" rel="" target="">
 <span class="menu-text">Meetup</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/m45hap" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Fitbit in your Google Sheets in 5 min or less</h1>
  <div class="quarto-categories">
    <div class="quarto-category">data</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Maria Prokofieva </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 30, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="intro.webp" class="img-fluid figure-img" width="300"></p>
</figure>
</div>
<p>We all want to be healthy (and wealthy!) and wearable devices is a popular answer to track your fitness level or check how close (or .. well.. not that close) to your fitness goals. Fitbit has been quite popular and used more than by 37 million only active users who use their device at least once a week, according to this <a href="https://www.statista.com/statistics/472600/fitbit-active-users/#:~:text=Fitbit%20%2D%20number%20of%20active%20users%202012%2D2022&amp;text=In%202022%2C%20there%20were%2037,at%20least%20once%20a%20week.&amp;text=The%20health%20and%20fitness%20wearable,vendors%20in%20this%20particular%20niche.">Statista</a> report.</p>
<p>so why not take a closer look at it? in your <a href="https://www.google.com/sheets/about/">Google Sheets</a>!</p>
<p>Downloading your data straight to Google Sheets is an awesome idea as you can:</p>
<p>analyse your data yourself, especially, if you have a particular fitness goal in mind (e.g.&nbsp;sleep for 8 hours on average, run a marathon each week, you name it!) share your data with someone (e.g.&nbsp;your doctor, your fitness trainer, your kid — YES, show them!) or you are just a control freak and what to make sure it’s YOURS. And Google Sheets makes it as convenient as possible — and as quick as possible, bet you — 5 minutes! (well, it’s telling me it’s 6 min reading time, so don’t count your reading time, pls!)</p>
<p>So, let’s dig it — well it is a mild dig, so no rollup sleeves, pls :)</p>
<hr>
<p>What we need:</p>
<p><a href="https://www.google.com/account/about/">Google Account</a> (with Google Sheets)</p>
<p>Fitbit with data and <a href="https://www.fitbit.com/">Fitbit account</a></p>
<p>… and 5 minutes of your time. The MOST HARD to get from the list!</p>
<p><strong>The result:</strong></p>
<p>Google Sheets with your Fitbit data and ability to synchronise it with time</p>
<section id="so-lets-do-it" class="level2">
<h2 class="anchored" data-anchor-id="so-lets-do-it"><img src="2.webp" class="img-fluid">So let’s do it!</h2>
<p>We will need work with your Google Sheets and your Fitbit developer account so have both handy open in two separate screens</p>
<p><strong>Google Sheets side</strong>: Go to Google Sheets and create a new file there</p>
<p><img src="1.webp" class="img-fluid"></p>
<p>Go to <strong>Extensions</strong> in the menu and click on <strong>Apps Script</strong></p>
<p><img src="4.webp" class="img-fluid"></p>
<p>We are going to use <a href="https://github.com/JKybett/GoogleFitBit">GoogleFitbit extension by JKybett</a></p>
<p>It’s “approved” by Fitbit and is listed under their page <a href="https://dev.fitbit.com/build/reference/web-api/developer-guide/libraries-and-sample-code/">here</a> — you will not get “hacked”</p>
<p>Now, you need to click on this link and copy all code from <a href="https://github.com/JKybett/GoogleFitBit/blob/main/FitBit.gs">here</a>.</p>
<p><img src="5.webp" class="img-fluid" width="562"></p>
<p>and click on the <strong>Save</strong> icon (little disk there on top!)</p>
<p>Click on Libraries + on the left hand side to see this pop-up window</p>
<p><img src="6.webp" class="img-fluid" width="350"></p>
<p>and search for THIS id below:</p>
<p><strong>1B7FSrk5Zi6L1rSxxTDgDEUsPzlukDsi4KGuTMorsTQHhGBzBkMun4iDF</strong></p>
<p>(if you don't trust me — check the link i provided earlier for the code!)</p>
<p><img src="7.webp" class="img-fluid" width="400"></p>
<p><strong>Version</strong>: select the latest (i.e.&nbsp;the bigger number! which is currently 43).</p>
<p><strong>Identifier</strong>: keep as is!</p>
<p>Click <strong>Add</strong> and close the window</p>
<p>Go back to your Google Sheets page and REFRESH! this is really important!</p>
<p>You will need to wait a few seconds (yeahhhh… veeeeeery looooong) and you will see <strong>Fitbit</strong> option in the menu</p>
<p><img src="8.webp" class="img-fluid" width="400"></p>
<p>Now, we need to actually set it up! so click on <strong>Fitbit</strong> and then <strong>Setup</strong></p>
<p><img src="9.webp" class="img-fluid" width="400"></p>
<p>It is most likely going to ask your permission to run the script we setup — so <strong>Continue</strong></p>
<p><img src="10.webp" class="img-fluid" width="400"></p>
<p>and you will need to provide your email for Fitbit and probably it is going to warn you again:</p>
<p><img src="11.webp" class="img-fluid" width="400"></p>
<p>and you click on <strong>Go to Fitbit (unsafe)</strong></p>
<p>and then we allow <strong>Fitbit</strong> to access our Google account, since we are going to pour its data to our Google Sheets</p>
<p><img src="12.webp" class="img-fluid" width="350"></p>
<p>Once it's done — you refresh your Google Sheets page again and select Fitbit&gt;Setup (again) to see this</p>
<p><img src="13.webp" class="img-fluid" width="350"></p>
<p>What you need to from this screen is the <strong>Redirect URL</strong> which you need to copy and paste (for your reference for now!) to be used 5 sec later when you go to..</p>
<p><strong>2. Fitbit side:</strong></p>
<p>Go to Fitbit <a href="https://dev.fitbit.com/">DEVELOPER website</a>. This is NOT your Fitbit account at <a href="https://www.fitbit.com/" class="uri">https://www.fitbit.com/</a></p>
<p>You need <a href="https://dev.fitbit.com/" class="uri">https://dev.fitbit.com/</a></p>
<p>Go to Manage&gt;Register An App (see here)</p>
<p><img src="14.webp" class="img-fluid" width="350"></p>
<p>and provide some details, but some of those entries can be what-ever-you-want (blurred on the screenshot), but others — you need to provide specific information (highlighted in RED).</p>
<p><img src="15.webp" class="img-fluid" width="350"></p>
<p>For those entries with <strong>UR</strong>L at the end — don't stress! you do not need your personal website. Remember, you are doing this for your OWN data!</p>
<p><strong>Application Name *:</strong> give it a name you like</p>
<p><strong>Description *:</strong> and description you like</p>
<p><strong>Application Website URL *:</strong> this needs to start with <strong>http://</strong> but then you can include ANYTHING (it may not be the real website for our purposes)</p>
<p><strong>Organization *:</strong> whatever-you-like</p>
<p><strong>Organization Website URL *:</strong> start with <strong>http://</strong> and then anything (e.g.&nbsp;http://google.com)</p>
<p><strong>Terms of Service URL *:</strong> same as for the above: start with <strong>http://</strong> and then anything</p>
<p><strong>Privacy Policy URL *:</strong> same!</p>
<p><strong>OAuth 2.0 Application Type *:</strong> select <strong>Personal</strong></p>
<p><strong>Redirect URL *:</strong> paste the code you were provided in Google Sheets !<strong>THIS IS REALLY IMPORTANT!</strong></p>
<p><strong>Default Access Type *:</strong> select <strong>Read &amp; Write</strong></p>
<p>Don't forget to put a checkbox in "I have read and agree to the <a href="http://dev.fitbit.com/terms">terms of service</a>"</p>
<p>After registering your app, you can access it and edit under "Manage my app" tab.</p>
<p><img src="16.webp" class="img-fluid" width="350"></p>
<p>whooohoo! we are getting close!</p>
<p>From the app page you need to note two codes:</p>
<p><strong>OAuth 2.0 Client ID</strong></p>
<p><strong>Client Secret</strong></p>
<p>We will use them in our Google Sheets</p>
<p><img src="17.webp" class="img-fluid" width="350"></p>
<p>So back there!</p>
<p><strong>Google Sheets (again)</strong></p>
<p>the next setup step is to enter the details of the freshly registered Fitbit app here (promise — we are nearly done!)</p>
<p><img src="18.webp" class="img-fluid" width="350"></p>
<p>and hit Submit!</p>
<p>THIS. IS. IT!</p>
<p>You quickly authorise your app one more time and…</p>
<p>MAGIC!</p>
<p>SEE THIS</p>
<p>your Google Sheets will be quickly populated with the dates and data you requested!</p>
<p><img src="19.webp" class="img-fluid" width="400"></p>
<p>as you can see — you can</p>
<ul>
<li><p>reset it (with your new details)</p></li>
<li><p>sync to get today's data</p></li>
<li><p>or get your Custom dates!</p></li>
</ul>
<p>Enjoy! you are the champ!</p>
<p><img src="20.webp" class="img-fluid" width="400"></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Maria Prokofieva</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://www.meetup.com/r-business/">Meetup</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/m45hap">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>